DROP DATABASE IF EXISTS sistema_reservas_vuelos;
CREATE DATABASE sistema_reservas_vuelos CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
USE sistema_reservas_vuelos;

CREATE TABLE pasajeros(
id_pasajero INT AUTO_INCREMENT PRIMARY KEY,
id_equipaje INT NOT NULL,
nombre VARCHAR(50) NOT NULL,
apellido VARCHAR(50) NOT NULL, 
dni_pasaporte VARCHAR(10) UNIQUE NOT NULL, 
email VARCHAR(100),
telefono VARCHAR(20),
FOREIGN KEY (id_equipaje) REFERENCES equipajes(id_equipaje)
);

CREATE TABLE equipajes(
id_equipaje INT AUTO_INCREMENT PRIMARY KEY,
cantidad INT NOT NULL,
peso DECIMAL(6,2) NOT NULL,
tamanio DECIMAL(6,2) NOT NULL,
tipo VARCHAR(50) NOT NULL
);

CREATE TABLE reservas(
id_reserva INT AUTO_INCREMENT PRIMARY KEY,
id_pasajero INT NOT NULL,
id_vuelo INT NOT NULL,
fecha_reserva DATE NOT NULL,
clase VARCHAR(50),
costo_total DECIMAL(6,2) NOT NULL,
asiento VARCHAR(5) NOT NULL,
estado VARCHAR(50) NOT NULL,
FOREIGN KEY (id_pasajero) REFERENCES pasajeros(id_pasajero),
FOREIGN KEY (id_vuelo) REFERENCES vuelos(id_vuelo),
UNIQUE(id_vuelo, asiento) #un aiento no se puede resrvar 2 veces
);

CREATE TABLE cancelaciones(
id_cancelacion INT AUTO_INCREMENT PRIMARY KEY,
id_reserva INT NOT NULL,
fecha_cancelacion DATE NOT NULL,
reembolso DECIMAL(6,2) NOT NULL,
FOREIGN KEY (id_reserva) REFERENCES reservas(id_reserva)
);

CREATE TABLE vuelos(
id_vuelo INT AUTO_INCREMENT PRIMARY KEY,
id_aeropuerto INT NOT NULL,
id_avion INT NOT NULL,
id_piloto INT NOT NULL,
origen VARCHAR(50) NOT NULL,
destino VARCHAR(50) NOT NULL,
numero_vuelo VARCHAR(10),
fecha_salida DATETIME NOT NULL,
fecha_llegada DATETIME NOT NULL,
FOREIGN KEY (id_aeropuerto) REFERENCES aeropuertos(id_aeropuerto),
FOREIGN KEY (id_avion) REFERENCES aviones(id_avion),
FOREIGN KEY (id_piloto) REFERENCES  pilotos(id_piloto)
);

CREATE TABLE aerolineas(
id_aerolinea INT AUTO_INCREMENT PRIMARY KEY,
nombre VARCHAR(100) NOT NULL,
mail VARCHAR(50),
telefono VARCHAR(20) NOT NULL
);

CREATE TABLE aviones(
id_avion INT AUTO_INCREMENT PRIMARY KEY,
id_aerolinea INT NOT NULL,
modelo VARCHAR(50),
marca VARCHAR(50),
capacidad INT NOT NULL,
FOREIGN KEY (id_aerolinea) REFERENCES aerolineas(id_aerolinea)
);

CREATE TABLE pilotos(
id_piloto INT AUTO_INCREMENT PRIMARY KEY,
nombre VARCHAR(50) NOT NULL,
apellido VARCHAR(50) NOT NULL,
a√±os_experiencia INT NOT NULL
);

CREATE TABLE aeropuertos(
id_aeropuerto INT AUTO_INCREMENT PRIMARY KEY,
nombre VARCHAR(50) NOT NULL,
ciudad VARCHAR(50) NOT NULL,
pais VARCHAR(50) NOT NULL,
codigo_iata VARCHAR(3) UNIQUE NOT NULL
);
